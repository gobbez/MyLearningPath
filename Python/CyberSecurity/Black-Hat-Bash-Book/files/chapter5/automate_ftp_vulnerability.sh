#!/bin/bash
# Get file with a list of IPs
INPUT_FILE=$1

# Check if available, else exit
if [ ! -f "$INPUT_FILE" ]; then
    echo "Usage: $0 host_list.txt"
    exit 1
fi

# Process every IP in the file
while read -r HOST; do
    echo "[+] Scanning $HOST"

    # Check if host is available (status 200)
    if ping -c 1 -W 1 "$HOST" &> /dev/null; then
        echo "  - $HOST is up"

	# Scan with Nmap to check if port 21 has FTP open
        PORT21=$(nmap -p 21 --open "$HOST" | grep "21/tcp open")

        if [[ -n "$PORT21" ]]; then
            echo "  - FTP port is open on $HOST"

            # Scan with Nuclei
            nuclei -u "$HOST" -tags ftp

            # Scan with Nmap NSE for anonymous FTP
            nmap -p 21 --script ftp-anon.nse "$HOST"
        else
            echo "  - FTP port is closed on $HOST"
        fi
    else
        echo "  - $HOST is down or unreachable"
    fi

done < "$INPUT_FILE"
